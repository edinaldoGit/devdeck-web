import{d as h,s as g,r as u,x as b,g as l,i as e,h as f,t as o,F as y,k,q as x,n as w,o as r,_ as U}from"./index-G_Ayme-S.js";const C={class:"inbox-container"},D={class:"msg-list-panel"},M={class:"mini-header"},A={key:0,class:"badge-count"},B={key:0,class:"loading-state"},S={key:1,class:"empty-list"},V={key:2,class:"scroll-list"},j=["onClick"],F=["src"],$={class:"msg-preview-info"},z={class:"msg-row-top"},E={class:"sender-name"},I={class:"msg-date"},L={class:"msg-subject"},N={class:"msg-excerpt"},q={class:"msg-content-panel"},O={key:0,class:"content-wrapper"},P={class:"msg-detail-header"},R={class:"sender-profile"},T=["src"],G={class:"meta"},H={class:"sub-meta"},J={class:"direction-badge"},K={class:"msg-body-scroll"},Q={class:"msg-paper"},W={key:1,class:"empty-content-placeholder"},X=h({__name:"MessagesView",setup(Y){const _=g(),i=u([]),n=u(null),d=u(!0);function c(t){return t.sender.id===_.user?.id?{...t.receiver,label:"Para: "}:{...t.sender,label:"De: "}}async function p(){d.value=!0;try{const{data:t}=await x.get("/messages/inbox"),a=Array.isArray(t)?t:[];i.value=a.map(s=>({...s,sender:{...s.sender,avatarUrl:s.sender?.avatarUrl||`https://ui-avatars.com/api/?name=${s.sender?.name||"User"}&background=random`},receiver:{...s.receiver,avatarUrl:s.receiver?.avatarUrl||`https://ui-avatars.com/api/?name=${s.receiver?.name||"User"}&background=random`}})),i.value.length>0&&(n.value=i.value[0]||null)}catch(t){console.error("Erro:",t)}finally{d.value=!1}}function m(t){n.value=t}function v(t){const a=new Date(t);return new Intl.DateTimeFormat("pt-BR",{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"}).format(a)}return b(()=>{p()}),(t,a)=>(r(),l("div",C,[e("aside",D,[e("div",M,[a[0]||(a[0]=e("span",{class:"label-inbox"},"Conversas",-1)),i.value.length?(r(),l("span",A,o(i.value.length),1)):f("",!0)]),d.value?(r(),l("div",B,[...a[1]||(a[1]=[e("div",{class:"spinner-sm"},null,-1)])])):i.value.length===0?(r(),l("div",S,[...a[2]||(a[2]=[e("i",{class:"bi bi-inbox"},null,-1),e("p",null,"Caixa de entrada vazia.",-1)])])):(r(),l("div",V,[(r(!0),l(y,null,k(i.value,s=>(r(),l("div",{key:s.id,class:w(["msg-item",{active:n.value?.id===s.id}]),onClick:Z=>m(s)},[e("img",{src:c(s).avatarUrl,class:"sender-avatar"},null,8,F),e("div",$,[e("div",z,[e("span",E,o(c(s).name),1),e("span",I,o(v(s.createdAt)),1)]),e("span",L,o(s.subject),1),e("p",N,o(s.content),1)])],10,j))),128))]))]),e("main",q,[n.value?(r(),l("div",O,[e("div",P,[e("div",R,[e("img",{src:c(n.value).avatarUrl,class:"avatar-lg"},null,8,T),e("div",G,[e("h2",null,o(n.value.subject),1),e("div",H,[e("span",J,o(c(n.value).label),1),e("strong",null,o(c(n.value).name),1),a[3]||(a[3]=e("span",{class:"dot"},"â€¢",-1)),e("span",null,o(v(n.value.createdAt)),1)])])])]),e("div",K,[e("div",Q,o(n.value.content),1)])])):(r(),l("div",W,[...a[4]||(a[4]=[e("i",{class:"bi bi-chat-left-text"},null,-1),e("p",null,"Selecione uma mensagem para ler",-1)])]))])]))}}),se=U(X,[["__scopeId","data-v-1a470b6e"]]);export{se as default};

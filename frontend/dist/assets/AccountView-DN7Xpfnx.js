import{d as y,s as x,u as _,r as f,m as k,g as u,i as s,a as S,z as C,p as c,v as p,b as V,e as E,T as A,f as D,q as g,h as T,j as B,l as b,E as N,t as U,B as M,o as d,_ as z}from"./index-G_Ayme-S.js";const $={class:"view-content"},K={class:"settings-container"},L={class:"glass-card security-card"},j={class:"form-content"},q={class:"form-group"},F={class:"input-wrapper readonly"},I=["value"],R={class:"password-grid"},Z={class:"form-group full-width"},G={class:"form-group"},H={class:"form-group"},J={class:"action-right"},O=["disabled"],Q={key:0},W={key:1},X={class:"glass-card danger-zone"},Y={class:"danger-content"},ss={class:"modal-container danger-modal glass-modal"},es={class:"modal-body"},as={class:"form-group mt-4"},os={class:"modal-footer"},ts=["disabled"],ns=y({__name:"AccountView",setup(ls){const v=x(),n=_(),h=M(),t=f(!1),l=f(!1),r=f(""),a=k({currentPassword:"",newPassword:"",confirmPassword:""});async function P(){if(a.newPassword!==a.confirmPassword){n.warning("A nova senha e a confirmação não conferem.");return}if(a.newPassword.length<6){n.warning("A senha deve ter no mínimo 6 caracteres.");return}t.value=!0;try{await g.put("/users/password",{currentPassword:a.currentPassword,newPassword:a.newPassword}),n.success("Senha alterada com sucesso!"),a.currentPassword="",a.newPassword="",a.confirmPassword=""}catch(i){const e=i.response?.data?.error||"Erro ao alterar senha.";n.error(e)}finally{t.value=!1}}async function w(){if(!r.value){n.warning("Digite sua senha para confirmar.");return}t.value=!0;try{await g.delete("/users/me",{data:{password:r.value}}),m()}catch(i){const e=i.response?.status,o=i.response?.data?.error||"";if(e===401||e===403||e===404){m();return}n.error(o||"Erro ao excluir conta.")}finally{t.value=!1}}function m(){l.value=!1,v.logout(),n.success("Sua conta foi excluída."),h.push("/").then(()=>{window.location.reload()})}return(i,e)=>(d(),u("div",$,[s("div",K,[s("section",L,[e[15]||(e[15]=s("div",{class:"card-header"},[s("div",{class:"icon-box white-icon"},[s("i",{class:"bi bi-shield-lock-fill"})]),s("h3",null,"Segurança e Login")],-1)),s("div",j,[s("div",q,[e[9]||(e[9]=s("label",null,"E-mail",-1)),s("div",F,[e[7]||(e[7]=s("i",{class:"bi bi-envelope"},null,-1)),s("input",{type:"text",value:C(v).user?.email,disabled:"",class:"input-glass has-badge"},null,8,I),e[8]||(e[8]=s("div",{class:"verified-badge"},[s("i",{class:"bi bi-check-circle-fill"}),s("span",null,"Verificado")],-1))])]),e[13]||(e[13]=s("hr",{class:"divider"},null,-1)),e[14]||(e[14]=s("h4",{class:"sub-title"},"Alterar Senha",-1)),s("div",R,[s("div",Z,[e[10]||(e[10]=s("label",null,"Senha Atual",-1)),c(s("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>a.currentPassword=o),type:"password",class:"input-glass",placeholder:"••••••••"},null,512),[[p,a.currentPassword]])]),s("div",G,[e[11]||(e[11]=s("label",null,"Nova Senha",-1)),c(s("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>a.newPassword=o),type:"password",class:"input-glass",placeholder:"••••••••"},null,512),[[p,a.newPassword]])]),s("div",H,[e[12]||(e[12]=s("label",null,"Confirmar",-1)),c(s("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>a.confirmPassword=o),type:"password",class:"input-glass",placeholder:"••••••••"},null,512),[[p,a.confirmPassword]])])]),s("div",J,[s("button",{class:"btn-glass-save",onClick:P,disabled:t.value||!a.currentPassword},[t.value?(d(),u("span",W,"Salvando...")):(d(),u("span",Q,"Atualizar Senha"))],8,O)])])]),s("section",X,[e[17]||(e[17]=s("div",{class:"card-header text-danger"},[s("div",{class:"icon-box danger"},[s("i",{class:"bi bi-exclamation-triangle-fill"})]),s("h3",null,"Zona de Perigo")],-1)),s("div",Y,[e[16]||(e[16]=s("div",{class:"danger-info"},[s("h4",null,"Excluir Conta"),s("p",null,"Essa ação é irreversível. Todos os seus dados serão perdidos.")],-1)),s("button",{class:"btn-delete",onClick:e[3]||(e[3]=o=>l.value=!0)}," Excluir minha conta ")])])]),(d(),S(D,{to:"body"},[V(A,{name:"modal-fade"},{default:E(()=>[l.value?(d(),u("div",{key:0,class:"modal-backdrop",onClick:e[6]||(e[6]=B(o=>l.value=!1,["self"]))},[s("div",ss,[e[20]||(e[20]=s("header",{class:"modal-header"},[s("div",{class:"danger-icon-wrapper"},[s("i",{class:"bi bi-exclamation-triangle-fill"})]),s("h3",null,"Excluir Conta Permanentemente?")],-1)),s("div",es,[e[19]||(e[19]=s("p",{class:"warning-text"},[b(" Você está prestes a apagar sua conta. "),s("strong",null,"Esta ação não pode ser desfeita."),b(" Por favor, digite sua senha para confirmar. ")],-1)),s("div",as,[e[18]||(e[18]=s("label",null,"Confirme sua senha",-1)),c(s("input",{"onUpdate:modelValue":e[4]||(e[4]=o=>r.value=o),type:"password",class:"input-glass danger-input w-100",placeholder:"Digite sua senha atual",onKeyup:N(w,["enter"])},null,544),[[p,r.value]])])]),s("footer",os,[s("button",{class:"btn-cancel",onClick:e[5]||(e[5]=o=>l.value=!1)},"Cancelar"),s("button",{class:"btn-confirm-delete",onClick:w,disabled:t.value||!r.value},U(t.value?"Excluindo...":"Sim, excluir tudo"),9,ts)])])])):T("",!0)]),_:1})]))]))}}),is=z(ns,[["__scopeId","data-v-df0d993f"]]);export{is as default};
